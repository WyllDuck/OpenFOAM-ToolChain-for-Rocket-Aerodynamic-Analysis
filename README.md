# Automatized & Modular OpenFOAM Workspace to Generate Large Aerodynamic Databases for Subsonic and Supersonic Vehicles 
__by F√©lix Mart√≠ Valverde__

This project provides a complete toolchain for evaluating different rocket geometries and subsonic, transonic, and supersonic regimes. The work contained in this repository is part of a student project carried out at the _Technical University of Munich_ (TUM) under the _Master of Science (M.Sc) in Aerospace_ (year 2023) which aims to provide a standalone and verified methodology to extract aerodynamic characteristics of a rocket using 3D CFD simulation with pressure and density based solvers found in OpenFOAM (ESI group distribution). 

![PNG Image](results.png)

## HIGHLIGHTS

<ul>
  <li>üöÄGeneration of specific OpenFOAM workspace using templates and <i>JSON</i> configuration files. Powered by <i>Jinja2</i>, a Python module.üöÄ</li>

  <li>üìÇStructured Layout for automatic generation of large aerodynamic databases.üìÇ</li>

  <li>ü§ñAutomatic generation of CFD reports with the generation of predefined images through Paraviews Python API.ü§ñ</li>

  <li>‚öôÔ∏èPlanned execution in series of multiple OpenFOAM simultations‚öôÔ∏è</li>

  <li>üêãUse of containers to speed up deployment of CFD serverüê≥ (5%‚¨áÔ∏è drop in efficiency)</li>

  <li>ü§ìExamples of OpenFOAM workspaces using <i>rhoPimpleFOAM</i> and <i>rhoCentralFoam</i> at subsonic, transonic, and supersonic regimes.ü§ì</li>
</ul>

## INTRODUCTION

Computational Fluid Dynamics (CFD) tools from providers like ANSYS (Fluent) or Siemens (Star-CCM+) can be a financial burden on small businesses and startups alike. Thus, open-source alternatives like OpenFOAM are becoming increasingly appealing to reduce development costs. However, OpenFOAM has largely remained a research tool reserved for academia due to its lack of documentation, the high level of expertise required, and a lack of standardization and Graphical User Interface (GUI). This project identifies these shortcomings and aims to streamline the process, which is generally reserved for academia, thus easing the commercial adoption of this tool. 

The entirety of the code has been publicly released in this repository to promote investigation using open-source and free tools. The results obtained during the development phase have been validated against wind tunnel data. The validation methodology can be found in the report "_Toolchain for Aerodynamic Characterization of a Rocket During Ascent using OpenFOAM_" along with the results obtained. Additionally, a set of simulation files for OpenFOAM (ESI group distribution) are also provided to provide a complete overview of the parameters utilized. 

### links


## SETUP

To set up the workspace download OpenFOAM ESI (www.openfoam.com) and the following additional tools which are necessary to run the full toolchain. Note that _SALOME_ is used to generate the surface of the vehicle from an initial _STEP_ file into an _STL_ file. More information on the procedure can be found in the report, and an example of the SALOME file can be found in the _Miscelaneous_ folder link above. 

<ul>
  <li>Paraview</li>
  <li>GNUPLOT</li>
  <li>Python 3</li>
  <li>SALOME</li>
  <li>GitHub</li>  
</ul>

Necessary Python modules for the execution of the pipeline are _jinja2-cli_ which can be installed using:

```python3 -m pip install jinja2-cli```

__OPTIONAL__
Other additional Python modules need to be installed to test solvers of structured meshes (see folder _sphereMesh_) which contains a Python file named _sphere.py_ using python module _classyblocks_ (https://github.com/damogranlabs/classy_blocks)

```python3 -m pip install classy-blocks```

Additional Tools that may interest the user to interact with the server and write the code are: 
<ul>
  <li>MobaXterm</li>
  <li>Visual Studio Code (VSC)</li>
  <li>XLaunch</li>
</ul>

Also, the project explores different alternatives to execute OpenFOAM on personal computers that might run Windows exclusively. In the report, performance drops when using containers (with Docker) or the Windows Subsystem for Linux (WSL) can be found, find a link to the file in the Introduction.

## CONTENT

The repository contains 3 fundamental folders: _rocketMesh_, _templates_, and _postProcessingTools_

<ul>
  <li><b>rocketMesh</b>: This folder contains a set of meshes of increasing resolution named R1 to R6. The user can choose from them to compute the solution.</li>
  <li><b>templates</b>: This folder contains templates of OpenFOAM workspace which use different _solvers_ (e.g.<i>rhoPimpleFoam</i>, <i>rhoSimpleFoam</i>, ...) and tune other parameters. The user must provide additional parameters using a <i>JSON</i> file to generate a complete OpenFOAM workspace.</li>
  
  <li><b>postProcessingTools</b>: Set of tools to generate: 
    <ul>
      <li>Real-time monitoring plots for residuals and aerodynamic coefficients.</li>
      <li>Autogenerated reports on single simulations containing images and stats (n¬∫ of iterations, CPU time, final aerodynamic coefficients, ...).</li>
      <li>Autogenerated Excel table (<i>CSV</i> files) with multiple simulations, same data as reports.</li>
    </ul>
  </li>
</ul>

Additional folders contained in the repository are extra resources that might come in handy. The submodule folder _OpenFOAM-ToolChain-helperFunctions_ (https://github.com/WyllDuck/OpenFOAM-ToolChain-helperFunctions) contains all the Python scripts used to calculate atmospheric conditions for each simulated case and extract the wind tunnel data to compare CFD results to. 

## EXECUTION

What follows is a diagram found in the report (see link to file above) that shows how to feed a configuration file (_JSON_ file) to a template to obtain a configured OpenFOAM simulation workspace. In the second stage, the diagram explains how to automatically execute the list of OpenFOAM workspaces by providing an ordering list and the workspaces.  

> [!IMPORTANT]  
> The __run__ folder is automatically generated as the storage location if non-existent when the automatic execution of simulation stars. On the same note, the __todo__ folder is automatically generated if non-existent when OpenFOAM workspaces are created as their storage location.

> [!IMPORTANT]
> Also, the configuration files are generated using Python scripts in the submodule folder _OpenFOAM-ToolChain-helperFunctions_ (https://github.com/WyllDuck/OpenFOAM-ToolChain-helperFunctions), please visit that repository for further information. 

![SVG Image](workflow.svg)


